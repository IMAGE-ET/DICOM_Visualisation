#include "displayFunc.h"

/**
 * @Title DisplayFunc
 * @description update rendering
 */
void DisplayFunc(void)
{
	glClear(GL_COLOR_BUFFER_BIT);

	glMatrixMode(GL_MODELVIEW);
	glLoadIdentity();
	glMatrixMode(GL_PROJECTION);
	glLoadIdentity();
	glViewport(0,0,width,height);
	glOrtho(-1.2, 1.2, -1.2, 1.2, -1.2, 1.2);

	glCallList(displayListIndex);

	/**
	 * bottom right
	 */
	glErrorCheck();

	glViewport((width/2)+0.5, 0, (width/2)-0.5, (height/2)-0.5);
	glMatrixMode(GL_MODELVIEW);
	glLoadIdentity();
	glMatrixMode(GL_PROJECTION);
	glLoadIdentity();
	glOrtho(-1.2, 1.2, -1.2, 1.2, -1.2, 1.2);
	glEnable(GL_TEXTURE_3D);

	VolumisedImage();
	glDisable(GL_TEXTURE_3D);
	glMatrixMode(GL_PROJECTION);
	glLoadIdentity();
	glOrtho(-1.2, 1.2, -1.2, 1.2, -1.2, 1.2);
	glMatrixMode(GL_MODELVIEW);
	glErrorCheck();

	/**
	 * top left
	 */
	glEnable(GL_TEXTURE_2D);
	glViewport(0, (height/2)+0.5, (width/2)-0.5, (height/2)-0.5);
	glPushMatrix();
	originalCT();
	glPopMatrix();
	glErrorCheck();

	/**
	 * top right
	 */
	glViewport((width/2)+0.5, (height/2)+0.5, (width/2)-0.5, (height/2)-0.5);
	glPushMatrix();
	xPlane();
	glPopMatrix();
	glErrorCheck();

	/**
	 * bottom left
	 */
	glViewport(0, 0, (width/2)-0.5, (height/2)-0.5);
	glPushMatrix();
	yPlane();
	glPopMatrix();
	glErrorCheck();

	glFlush();
	glutSwapBuffers();
	glutPostRedisplay();
}
